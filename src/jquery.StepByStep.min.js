// StepByStep.js — https://github.com/vladkampov/StepByStep.js
// Licensed under the MIT license - http://opensource.org/licenses/MIT
// Copyright © 2015 Vlad Kampov
// http://kampov.com/
!function(t){jQuery.fn.StepByStep=function(i){function e(t,i){var e=parseInt(t.slice(1),16),s=Math.round(2.55*i),a=(e>>16)+s,n=(e>>8&255)+s,o=(255&e)+s;return"#"+(16777216+65536*(255>a?1>a?0:a:255)+256*(255>n?1>n?0:n:255)+(255>o?1>o?0:o:255)).toString(16).slice(1)}function s(t,i){return t=t.replace("#",""),r=parseInt(t.substring(0,2),16),g=parseInt(t.substring(2,4),16),b=parseInt(t.substring(4,6),16),result="rgba("+r+","+g+","+b+","+i/100+")",result}i=t.extend({lineColor:"#e7e7e7",active:1,inactiveColor:"#e7e7e7",numColor:"#222",numColorActive:"#fff",activeColors:["#ec0101","#ffbf00","#00a9fe","#1bb012","#888"],colorLast:"#004179",after:"StepByStep-after"},i);var a=function(){function a(){r.last().find("div:nth-child(2)").animate({height:l/4},400).animate({height:l/5},400),r.last().find("div:nth-child(3)").animate({"margin-top":"-0.2em"},400).animate({"margin-top":"-0.3em"},400)}var n=t(this).find("ul"),o=document.createElement("li");n.append(o);var r=n.find("li");r.css({"float":"left","text-align":"left",width:100/n.children().length+1+"%","margin-top":"-1.15em",position:"relative",height:"350px","z-index":2}),r.first().css("margin-left",25/n.children().length+1+"%"),t(this).css({width:"100%"}),r.last().css({width:100/(2*n.children().length)+"%"});var c=t(".step-details"),l=0;jQuery.each(c,function(e){e<=i.active-1?(t(this).parent().addClass("active"),t(this).css("visibility","active")):t(this).css("visibility","hidden"),e%2==0?(t(this).css({padding:"0.4em 1em 0","margin-top":"1em"}),t(this).parent().find("p").css({margin:0})):(t(this).css({padding:"0 1em 0.4em"}),height=t(this).find("p").height(),t(this).css({"margin-top":"-10em"}),height>l&&(l=height),t(this).parent().find("h3").css({"margin-top":0}))}),r.css({height:l}),n.css({"list-style-type":"none",background:i.lineColor,height:"2px","margin-top":l,"margin-bootom":l/4,padding:"initial"}),c.css({"margin-left":"1.25em","border-left":"1px solid "+i.inactiveColor,opacity:0,position:"absolute",width:"160%","z-index":996});var d=document.createElement("div");r.prepend(d).find("div:nth-child(1)").addClass("number"),jQuery.each(r,function(i){t(this).find(".number").text(parseInt(i)+1)});{var h=t("div.number"),p=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,m=p.exec(i.inactiveColor);"rgba("+parseInt(m[1],16)+","+parseInt(m[2],16)+","+parseInt(m[3],16)+",0.5);"}h.css({"font-weight":"bold",background:i.inactiveColor,color:i.numColor,padding:"0.65em 1em","border-radius":"50%",display:"inline-block","font-size":"1em","box-shadow":"0 0 0 0.5em "+s(i.inactiveColor,50),"-webkit-transition-duration":".4s","-o-transition-duration":".4s","-moz-transition-duration":".4s","transition-duration":".4s",cursor:"pointer","z-index":999,position:"absolute"}),jQuery.each(t("div.number"),function(a){t(this).parent().hasClass("active")&&(t(this).css({background:i.activeColors[a],"box-shadow":"0 0 0 0.5em "+s(i.activeColors[a],50),color:i.numColorActive}),t(this).parent().find(".step-details").find("h3").css({color:e(i.activeColors[a],-10)}),t(this).parent().find(".step-details").css({"border-left":"1px solid "+i.activeColors[a],opacity:1}))}),h.click(function(){if(t(this).parent().hasClass("active")||t(this).hasClass("last")){t(this).parent().removeClass("active"),t(this).css({background:i.inactiveColor,"box-shadow":"0 0 0 0.5em "+s(i.inactiveColor,50),color:i.numColor}),t(this).parent().find(c).css({opacity:1,visibility:"visible"}).animate({opacity:0},200);var a=t(this).parent().index();a!=n.children().length-1&&jQuery.each(r,function(e){return e==n.children().length-1?!1:e>a?(t(this).removeClass("active"),t(this).find(h).css({background:i.inactiveColor,"box-shadow":"0 0 0 0.5em "+s(i.inactiveColor,50),color:i.numColor}),t(this).find(c).css({opacity:1}).animate({opacity:0},200),void 0):!0})}else{t(this).parent().find(".step-details").find("h3").css({color:e(i.activeColors[t(this).parent().index()],-10)}),t(this).parent().addClass("active"),t(this).css({background:i.activeColors[t(this).parent().index()],"box-shadow":"0 0 0 0.5em "+s(i.activeColors[t(this).parent().index()],50),color:i.numColorActive}),t(this).parent().find(c).css({visibility:"visible","border-left":"1px solid "+i.activeColors[t(this).parent().index()]}).animate({opacity:1},500);var a=t(this).parent().index();a!=n.children().length-1&&jQuery.each(r,function(o){return o==n.children().length-1?!1:a>o?(t(this).addClass("active"),t(this).find(h).css({background:i.activeColors[t(this).index()],"box-shadow":"0 0 0 0.5em "+s(i.activeColors[t(this).index()],50),color:i.numColorActive}),t(this).find(".step-details").find("h3").css({color:e(i.activeColors[t(this).index()],-10)}),t(this).find(c).css({visibility:"visible","border-left":"1px solid "+i.activeColors[t(this).index()]}).animate({opacity:1},500),void 0):!0})}}),h.hover(function(){t(this).parent().hasClass("active")||t(this).css({background:i.activeColors[t(this).parent().index()],"box-shadow":"0 0 0 0.5em "+s(i.activeColors[t(this).parent().index()],50),color:i.numColorActive})},function(){t(this).parent().hasClass("active")||t(this).css({background:i.inactiveColor,"box-shadow":"0 0 0 0.5em "+s(i.inactiveColor,50),color:i.numColor})}),r.last().find(h).addClass("last").css({color:i.colorLast}).text("...");var f=document.createElement("div");r.last().append(f).find("div:nth-child(2)").addClass("arrowDown").css({height:l/4,"border-left":"1px solid "+i.inactiveColor,"margin-left":"1.3em","margin-top":"2em"});var v=document.createElement("div");r.last().append(v).find("div:nth-child(3)").addClass("DaFckDown").text("<").css({"font-size":"2.3em","-webkit-transform":"rotate(-90deg)","-moz-transform":"rotate(-90deg)",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)","-o-transform":"rotate(-90deg)",position:"absolute","margin-left":"0.32em","margin-top":"-0.3em"}).animate({"margin-top":"0em"},350).animate({"margin-top":"-0.3em"},350),setInterval(a,0),r.last().attr("data-after",i.after),r.last().find(h).click(function(){var i=t(this).parent().attr("data-after");return t("html, body").animate({scrollTop:t("#"+i).offset().top},1e3),!1})};return this.each(a)}}(jQuery);